<div class="m-5">
    <div class="container">
        <h2 class="text-center mt-4">Jerarquía de Usuarios</h2>
        <br>
        <?php
        // Crear un arreglo para organizar los usuarios por nivel
        $niveles = [];
        foreach ($pyramid as $usuario) {
            $nivel = $usuario['HIERARCHY_LEVEL'];
            $niveles[$nivel][] = $usuario;
        }

        // Generar el HTML dinámicamente para cada nivel
        foreach ($niveles as $nivel => $usuarios) {
            echo "<div class='card mb-4'>";
            echo "<div class='card-header'>Nivel {$nivel}</div>";
            echo "<div class='card-body'>";
            foreach ($usuarios as $usuario) {
                echo "
                    <div class='pyramid-item mb-2'>
                        <i class='bi bi-person-circle'></i>
                        <strong>{$usuario['NAME']}</strong><br>
                    </div>
                ";
            }
            echo "</div>";
            echo "</div>";
        }
        ?>
        <br>
    </div>
</div>